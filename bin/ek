#!/usr/bin/env bash

_chef_command="/opt/chefdk/bin/chef"

if [ -z $CHEF_ORG ]; then
  echo -e '\033[31mYou need to set $CHEF_ORG to use this command\033[0m'
  exit 1
fi

if [ -z $CHEF_KNIFE_CONFIG ]; then
  echo -e '\033[31mYou need to set $CHEF_KNIFE_CONFIG and point it to your universal knife.rb config\033[0m'
  exit 1
fi

if ! type $_chef_command &> /dev/null; then
  echo -e '\033[31mYou need to install chefdk, "brew cask install chefdk"\033[0m'
  exit 1
fi

eval "$($_chef_command shell-init bash)"

# echo "${@}"
knife "${@}" -c $CHEF_KNIFE_CONFIG
